<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>L$J的小书屋</title>
<link type="text/css" rel="stylesheet" href="login.css">
</head>
<body>
<div id="title"><h1>L$J的小书屋</h1></div>
<div id="tu"><img src="images/shu.jpeg"></div>
<div id="login">
<br>
<br>
<div id="titles">
<h1>马上登录买买买</h1>
</div>
<span>用户名：</span><input type="text" name="uname" id="uname"/><br/>
<span>密码：</span><input type="password" name="pwd" id="pwd"/><br/>
<input type="text" name="yanzhen"id="yanzheng">
<input type="text" id="yanzhengtxt">
<div id="button">
<input type="button" value="注册" class="denglu" onclick="zhuce()" >
<input type="button" value="登录" class="denglu" onclick="login()" >
</div>
</div>
<script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
<script>
window.onload=function()
{
	let a=Math.floor(Math.random()*(9999-1000)+1000);
	var b=document.getElementById("yanzhengtxt");
	b.value=a;
	
}
function login()
//首先，先获取我们注册的值
{
let uname=$("#uname").val();
let pwd=$("#pwd").val();

//中等，开始发送ajax请求
//请求地址 传过去的参数 请求成功后的回调函数  返回的数据类型

$.post("logins",
		{
	    op:'reg',
	    uname:uname,
	    pwd:pwd
		},
		function(data)
		{
			if(data==1)
				
				
				{
				var b=document.getElementById("yanzhengtxt");
				var c=document.getElementById("yanzheng");
				if(b.value!=c.value)
					{
					alert("验证码不正确");
					
					}
				else
					{
				alert("登录成功，即将跳转至主界面");
				//传递给主页面的值即用户名
				if(window.localStorage){
					//存储变量的值
					localStorage.name=document.all.uname.value;
					location.href="indexljf.html";
				}else{
					console.log("存储用户名失败");
				}
					}
				}
				
				else
				{
					alert("用户名或密码不正确");
				}
				
		}
		,"text");
		

		
}

function zhuce()
{
	location.href="zhuce.html";
}
</script>
</body>
</html>