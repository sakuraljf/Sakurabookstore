
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>L$J的小书屋</title>
<link type="text/css" rel="stylesheet" href="zhuce.css">
</head>
<body>
<div id="title"><h1>L$J的小书屋</h1></div>
<div id="tu"><img src="images/shus1.jpg"></div>
<div id="register">
<div id="aaa"></div>
<span >请输入您的用户名：</span><input type="text" class="txt" name="uname" id="uname"/><br />
<span >请输入您的密码：</span><input type="password" class="txt" name="pwd" id="pwd" placeholder="密码由8-20位字母、数字和特殊字符组成"/><br />
<span >请输入您的密码：</span><input type="password" class="txt" name="repwd" id="repwd" placeholder="密码由8-20位字母、数字和特殊字符组成"/><br />
<span >请输入您的手机号：</span><input type="tel" class="txt" name="tel" id="tel"/><br />
<span >请输入您的邮箱：</span><input type="text" class="txt" name="eamil" id="email"/><br />
<input type="button" id="btn" value="注册" onclick="reg()"/>
 </div>   
    <script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>
    <script>
        function reg(){
        	let uname=$("#uname").val();
        	let pwd=$("#pwd").val();
        	let repwd=$("#repwd").val();
        	let tel=$("#tel").val();
        	let email=$("#email").val();
        	
        	 $.post("member",{
             	op:'yanzhen',
             	uname:uname,
             },function(data){
             	if(data==-1){
             		let uname=$("#uname").val();
                  	let pwd=$("#pwd").val();
                  	let repwd=$("#repwd").val();
                  	let tel=$("#tel").val();
                  	let email=$("#email").val();
                	  $(function(){
                		  if(uname==""){
                	        	alert("亲，您的用户名还空着呢！");
                				return;
                	        }
                	        
                	        if(pwd==""){
                	        	alert("亲，您的密码还空着呢！");
                				return;
                	        }
                	        var pwdRegex = new RegExp('(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).{8,20}');
                	        if (!pwdRegex.test(pwd)) {
                	            alert("您的密码复杂度太低（密码中必须包含字母、数字、特殊字符），请及时修改密码！");
                	            return;
                	        }
                	        if(repwd==""){
                	        	alert("亲，请再次输入密码哦！");
                				return;
                	        }
                	        if(pwd!=repwd){
                	        	alert("两次输入的密码不一致!");
                	        	return;
                	        }
                	        
                	        if(tel==""){
                	        	alert("亲，您的电话号码还空着呢！");
                				return;
                	        }
                	        var regu = /^1[3|4|5|7|8]\d{9}$/;
                	        if(!regu.test(tel)){
                				alert("您输入的电话号码格式不正确!");
                				return;
                			}
                	        
                	        if(email == ""){
                				alert("亲，您的电子邮箱空着呢！");
                				return;
                			}
                	        var regExp = /\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
                	        if(!regExp.test(email)){
                				alert("您输入的E-mail地址不正确!");
                				return;
                			}
                	        
                	        $.post("member",{
                	        	op:'reg',
                	        	uname:uname,
                	        	pwd:pwd,
                	        	tel:tel,
                	        	email:email
                	        },function(data){
                	        	if(data==1){
                	        	   alert("注册成功，即将跳转到登录页面");
                	        	   
                	        	   location.href="login.html";
                	        	}else{
                	        	   alert("注册失败");
                	        	}
                	        },"text"); 
                		  
                	  })
             	  
             	}else{
             	alert("用户名已存在，请换一个哦");
             	    }
             	}
             ,"text");
        	 
        	 }
      
    </script>
</body>
</html>